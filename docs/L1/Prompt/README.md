# æç¤ºå·¥ç¨‹(Prompt Engineering)


<img width="900" alt="L1-2" src="https://github.com/user-attachments/assets/4834591e-48dd-4d12-8fe4-3f8e548f849c">


## 1.1 ä»€ä¹ˆæ˜¯Prompt(æç¤ºè¯)

Promptæ˜¯ä¸€ç§ç”¨äºæŒ‡å¯¼ä»¥å¤§è¯­è¨€æ¨¡å‹ä¸ºä»£è¡¨çš„**ç”Ÿæˆå¼äººå·¥æ™ºèƒ½**ç”Ÿæˆå†…å®¹(æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘ç­‰)çš„è¾“å…¥æ–¹å¼ã€‚å®ƒé€šå¸¸æ˜¯ä¸€ä¸ªç®€çŸ­çš„æ–‡æœ¬æˆ–é—®é¢˜ï¼Œç”¨äºæè¿°ä»»åŠ¡å’Œè¦æ±‚ã€‚

Promptå¯ä»¥åŒ…å«ä¸€äº›ç‰¹å®šçš„å…³é”®è¯æˆ–çŸ­è¯­ï¼Œç”¨äºå¼•å¯¼æ¨¡å‹ç”Ÿæˆç¬¦åˆç‰¹å®šä¸»é¢˜æˆ–é£æ ¼çš„å†…å®¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¦ç”Ÿæˆä¸€ç¯‡å…³äºâ€œäººå·¥æ™ºèƒ½â€çš„æ–‡ç« ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œäººå·¥æ™ºèƒ½â€ä½œä¸ºPromptï¼Œè®©æ¨¡å‹ç”Ÿæˆä¸€ç¯‡å…³äºäººå·¥æ™ºèƒ½çš„ä»‹ç»ã€åº”ç”¨ã€å‘å±•ç­‰æ–¹é¢çš„æ–‡ç« ã€‚

Promptè¿˜å¯ä»¥åŒ…å«ä¸€äº›ç‰¹å®šçš„æŒ‡ä»¤æˆ–è¦æ±‚ï¼Œç”¨äºæ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„è¯­æ°”ã€é£æ ¼ã€é•¿åº¦ç­‰æ–¹é¢ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œè¯·ç”¨å¹½é»˜çš„è¯­æ°”æè¿°äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹â€ä½œä¸ºPromptï¼Œè®©æ¨¡å‹ç”Ÿæˆä¸€ç¯‡å¹½é»˜é£è¶£çš„æ–‡ç« ã€‚

æ€»ä¹‹ï¼ŒPromptæ˜¯ä¸€ç§çµæ´»ã€å¤šæ ·åŒ–çš„è¾“å…¥æ–¹å¼ï¼Œå¯ä»¥ç”¨äºæŒ‡å¯¼å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆå„ç§ç±»å‹çš„å†…å®¹ã€‚

![](https://files.mdnice.com/user/56306/2bdd81c5-b3f8-4ced-b3f8-7ab471ec11e8.png)

## 1.2 ä»€ä¹ˆæ˜¯æç¤ºå·¥ç¨‹

æç¤ºå·¥ç¨‹æ˜¯ä¸€ç§é€šè¿‡è®¾è®¡å’Œè°ƒæ•´è¾“å…¥(Prompts)æ¥æ”¹å–„æ¨¡å‹æ€§èƒ½æˆ–æ§åˆ¶å…¶è¾“å‡ºç»“æœçš„æŠ€æœ¯ã€‚

åœ¨æ¨¡å‹å›å¤çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆè·å–ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬ï¼Œç„¶åå¤„ç†æ–‡æœ¬ç‰¹å¾å¹¶æ ¹æ®è¾“å…¥æ–‡æœ¬ç‰¹å¾é¢„æµ‹ä¹‹åçš„æ–‡æœ¬ï¼ŒåŸç†ä¸º**next token prediction**ï¼Œç±»ä¼¼æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„è¾“å…¥æ³•ã€‚


![](https://files.mdnice.com/user/43439/b4d0060a-d057-4e04-ad73-ee42d61cbbc7.png)


æç¤ºå·¥ç¨‹æ˜¯æ¨¡å‹æ€§èƒ½ä¼˜åŒ–çš„åŸºçŸ³ï¼Œæœ‰ä»¥ä¸‹å…­å¤§åŸºæœ¬åŸåˆ™ï¼š

- æŒ‡ä»¤è¦æ¸…æ™°
- æä¾›å‚è€ƒå†…å®¹
- å¤æ‚çš„ä»»åŠ¡æ‹†åˆ†æˆå­ä»»åŠ¡
- ç»™ LLMâ€œæ€è€ƒâ€æ—¶é—´(ç»™å‡ºè¿‡ç¨‹)
- ä½¿ç”¨å¤–éƒ¨å·¥å…·
- ç³»ç»Ÿæ€§æµ‹è¯•å˜åŒ–


åœ¨æç¤ºå·¥ç¨‹ä¸­ï¼Œç¬¬ä¸€ç‚¹ç»™å‡ºæ¸…æ™°çš„æŒ‡ä»¤æ˜¯è‡³å…³é‡è¦çš„ã€‚ä¸€ä¸ªæœ‰æ•ˆçš„æŒ‡ä»¤é€šå¸¸åŒ…å«ä»¥ä¸‹è¦ç´ ï¼šèƒŒæ™¯ã€ä»»åŠ¡ã€è¦æ±‚ã€é™åˆ¶æ¡ä»¶ã€ç¤ºä¾‹ã€è¾“å‡ºæ ¼å¼å’Œç›®æ ‡ã€‚é€šè¿‡æä¾›è¿™äº›è¯¦ç»†ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å¯¼æ¨¡å‹ç”Ÿæˆæ›´ç¬¦åˆæˆ‘ä»¬æœŸæœ›çš„æ–‡æœ¬ã€‚

è®©æˆ‘ä»¬ä»¥"ä¸ºAIå¤§æ¨¡å‹è®­ç»ƒè¥ç”Ÿæˆä»‹ç»æ–‡æ¡ˆ"ä¸ºä¾‹ï¼Œæ¥å±•ç¤ºå¦‚ä½•é€æ­¥ä¼˜åŒ–æŒ‡ä»¤ï¼Œä»¥è·å¾—æ›´ç†æƒ³çš„AIç”Ÿæˆå†…å®¹ï¼š

ç¬¬ä¸€ç‰ˆæç¤ºè¯ï¼ˆåŸºç¡€ç‰ˆï¼‰ï¼š
```
å†™ä¸€æ®µè¯ä»‹ç»AIå¤§æ¨¡å‹è®­ç»ƒè¥
```

![](https://files.mdnice.com/user/43439/5b256621-a991-47ee-9197-84c1b6cd33c7.jpg)


ç¬¬äºŒç‰ˆæç¤ºè¯ï¼ˆå¢åŠ è¡¨æƒ…å…ƒç´ ï¼‰ï¼š
```
å†™ä¸€æ®µè¯ä»‹ç»AIå¤§æ¨¡å‹è®­ç»ƒè¥ï¼Œæ·»åŠ emojiè¡¨æƒ…
```

![](https://files.mdnice.com/user/43439/ac0fb42d-f024-43d5-9663-0e7ab99a660b.jpg)


ç¬¬ä¸‰ç‰ˆæç¤ºè¯ï¼ˆè¿›ä¸€æ­¥ä¼˜åŒ–ç»“æ„ï¼‰ï¼š
```
å†™ä¸€æ®µè¯ä»‹ç»AIå¤§æ¨¡å‹è®­ç»ƒè¥ï¼Œæ·»åŠ emojiè¡¨æƒ…ï¼Œç»“æ„åŒ–æ’ç‰ˆ
```

![](https://files.mdnice.com/user/43439/ca0612aa-c99c-4d61-a208-05581a9ee57a.jpg)


é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œéšç€æŒ‡ä»¤çš„é€æ­¥å®Œå–„ï¼ŒAIç”Ÿæˆçš„å†…å®¹è´¨é‡ä¹Ÿéšä¹‹æå‡ã€‚è¿™ç§æ¸è¿›å¼çš„æç¤ºè¯ä¼˜åŒ–æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°æŒæ§AIè¾“å‡ºï¼Œè·å¾—æ›´ç¬¦åˆéœ€æ±‚çš„ç»“æœã€‚

å…¶ä»–æŠ€å·§æˆ‘ä»¬è¿™é‡Œä¸åšè¿‡å¤šä»‹ç»ï¼Œå¦‚æœå¤§å®¶æ„Ÿå…´è¶£å¯ä»¥å‚è€ƒä¸‹é¢çš„èµ„æ–™ï¼š

* [OpenAI å®˜æ–¹æç¤ºå·¥ç¨‹æŒ‡å—](https://platform.openai.com/docs/guides/prompt-engineering)
* [Claude å®˜æ–¹æç¤ºå·¥ç¨‹æŒ‡å—](https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/overview)
* [LangGPT çŸ¥è¯†åº“](https://langgptai.feishu.cn/wiki/RXdbwRyASiShtDky381ciwFEnpe)
* [ä¸‡å­—è§£è¯»ChatGPTæç¤ºè¯æœ€ä½³æ¡ˆä¾‹](https://langgptai.feishu.cn/wiki/IpdUwZRzgiYYH7kuOsDc3fWrnkg)


## 1.3 æç¤ºè®¾è®¡æ¡†æ¶

- CRISPEï¼Œå‚è€ƒï¼š[https://github.com/mattnigh/ChatGPT3-Free-Prompt-List](https://github.com/mattnigh/ChatGPT3-Free-Prompt-List)

  - **C**apacity and **R**ole (èƒ½åŠ›ä¸è§’è‰²)ï¼šå¸Œæœ› ChatGPT æ‰®æ¼”æ€æ ·çš„è§’è‰²ã€‚â€‹
  - **I**nsight (æ´å¯ŸåŠ›)ï¼šèƒŒæ™¯ä¿¡æ¯å’Œä¸Šä¸‹æ–‡(å¦ç‡è¯´æ¥æˆ‘è§‰å¾—ç”¨ Context æ›´å¥½)â€‹
  - **S**tatement (æŒ‡ä»¤)ï¼šå¸Œæœ› ChatGPT åšä»€ä¹ˆã€‚â€‹
  - **P**ersonality (ä¸ªæ€§)ï¼šå¸Œæœ› ChatGPT ä»¥ä»€ä¹ˆé£æ ¼æˆ–æ–¹å¼å›ç­”ä½ ã€‚â€‹
  - **E**xperiment (å°è¯•)ï¼šè¦æ±‚ ChatGPT æä¾›å¤šä¸ªç­”æ¡ˆã€‚

  å†™å‡ºçš„æç¤ºå¦‚ä¸‹ï¼š

  ```
  Act as an expert on software development on the topic of machine learning frameworks, and an expert blog writer. The audience for this blog is technical professionals who are interested in learning about the latest advancements in machine learning. Provide a comprehensive overview of the most popular machine learning frameworks, including their strengths and weaknesses. Include real-life examples and case studies to illustrate how these frameworks have been successfully used in various industries. When responding, use a mix of the writing styles of Andrej Karpathy, Francois Chollet, Jeremy Howard, and Yann LeCun.
  ```

- CO-STARï¼Œå‚è€ƒï¼š[https://aiadvisoryboards.wordpress.com/2024/01/30/co-star-framework/](https://aiadvisoryboards.wordpress.com/2024/01/30/co-star-framework/)

  ![](https://files.mdnice.com/user/56306/ab84b4d0-843c-460b-925a-16e07fefc595.png)

    - **C**ontext (èƒŒæ™¯): æä¾›ä»»åŠ¡èƒŒæ™¯ä¿¡æ¯â€‹
    - **O**bjective (ç›®æ ‡): å®šä¹‰éœ€è¦LLMæ‰§è¡Œçš„ä»»åŠ¡â€‹
    - **S**tyle (é£æ ¼): æŒ‡å®šå¸Œæœ›LLMå…·å¤‡çš„å†™ä½œé£æ ¼â€‹
    - **T**one (è¯­æ°”): è®¾å®šLLMå›å¤çš„æƒ…æ„ŸåŸºè°ƒâ€‹
    - **A**udience (è§‚ä¼—): è¡¨æ˜å›å¤çš„å¯¹è±¡â€‹
    - **R**esponse (å›å¤): æä¾›å›å¤æ ¼å¼

    ä¾‹å¦‚æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªè§£å†³æ–¹æ¡ˆä¸“å®¶ï¼Œç”¨äºæŠŠç›®æ ‡æ‹†è§£ä¸ºå¯æ‰§è¡Œçš„è®¡åˆ’ï¼Œå®Œæˆçš„æç¤ºè¯å¦‚ä¸‹ï¼š

    ```
    # CONTEXT # 
    æˆ‘æ˜¯ä¸€åä¸ªäººç”Ÿäº§åŠ›å¼€å‘è€…ã€‚åœ¨ä¸ªäººå‘å±•å’Œç”Ÿäº§åŠ›é¢†åŸŸ,äººä»¬è¶Šæ¥è¶Šéœ€è¦è¿™æ ·çš„ç³»ç»Ÿ:ä¸ä»…èƒ½å¸®åŠ©ä¸ªäººè®¾å®šç›®æ ‡,è¿˜èƒ½å°†è¿™äº›ç›®æ ‡è½¬åŒ–ä¸ºå¯è¡Œçš„æ­¥éª¤ã€‚è®¸å¤šäººåœ¨å°†æŠ±è´Ÿè½¬åŒ–ä¸ºå…·ä½“è¡ŒåŠ¨æ—¶é‡åˆ°å›°éš¾,å‡¸æ˜¾å‡ºéœ€è¦ä¸€ä¸ªæœ‰æ•ˆçš„ç›®æ ‡åˆ°ç³»ç»Ÿçš„è½¬æ¢è¿‡ç¨‹ã€‚

    #########

    # OBJECTIVE #
    æ‚¨çš„ä»»åŠ¡æ˜¯æŒ‡å¯¼æˆ‘åˆ›å»ºä¸€ä¸ªå…¨é¢çš„ç³»ç»Ÿè½¬æ¢å™¨ã€‚è¿™æ¶‰åŠå°†è¿‡ç¨‹åˆ†è§£ä¸ºä¸åŒçš„æ­¥éª¤,åŒ…æ‹¬è¯†åˆ«ç›®æ ‡ã€è¿ç”¨5ä¸ªä¸ºä»€ä¹ˆæŠ€å·§ã€å­¦ä¹ æ ¸å¿ƒè¡ŒåŠ¨ã€è®¾å®šæ„å›¾ä»¥åŠè¿›è¡Œå®šæœŸå›é¡¾ã€‚ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé€æ­¥æŒ‡å—,ä»¥æ— ç¼åœ°å°†ç›®æ ‡è½¬åŒ–ä¸ºå¯è¡Œçš„è®¡åˆ’ã€‚

    #########

    # STYLE #
    ä»¥å¯Œæœ‰ä¿¡æ¯æ€§å’Œæ•™è‚²æ€§çš„é£æ ¼å†™ä½œ,ç±»ä¼¼äºä¸ªäººå‘å±•æŒ‡å—ã€‚ç¡®ä¿æ¯ä¸ªæ­¥éª¤çš„å‘ˆç°éƒ½æ¸…æ™°è¿è´¯,è¿åˆé‚£äº›æ¸´æœ›æé«˜ç”Ÿäº§åŠ›å’Œå®ç°ç›®æ ‡æŠ€èƒ½çš„å—ä¼—ã€‚

    #########

    # Tone #
    å§‹ç»ˆä¿æŒç§¯æå’Œé¼“èˆäººå¿ƒçš„è¯­æ°”,åŸ¹å…»ä¸€ç§èµ‹æƒå’Œé¼“åŠ±çš„æ„Ÿè§‰ã€‚åº”è¯¥æ„Ÿè§‰åƒæ˜¯ä¸€ä½å‹å¥½çš„å‘å¯¼åœ¨æä¾›å®è´µçš„è§è§£ã€‚

    # AUDIENCE #
    ç›®æ ‡å—ä¼—æ˜¯å¯¹ä¸ªäººå‘å±•å’Œæé«˜ç”Ÿäº§åŠ›æ„Ÿå…´è¶£çš„ä¸ªäººã€‚å‡è®¾è¯»è€…å¯»æ±‚å®ç”¨å»ºè®®å’Œå¯è¡Œæ­¥éª¤,ä»¥å°†ä»–ä»¬çš„ç›®æ ‡è½¬åŒ–ä¸ºåˆ‡å®çš„æˆæœã€‚

    #########

    # RESPONSE FORMAT #
    æä¾›ä¸€ä¸ªç»“æ„åŒ–çš„ç›®æ ‡åˆ°ç³»ç»Ÿè½¬æ¢è¿‡ç¨‹æ­¥éª¤åˆ—è¡¨ã€‚æ¯ä¸ªæ­¥éª¤éƒ½åº”è¯¥æ¸…æ™°å®šä¹‰,æ•´ä½“æ ¼å¼åº”æ˜“äºéµå¾ªä»¥ä¾¿å¿«é€Ÿå®æ–½ã€‚

    #############

    # START ANALYSIS #
    å¦‚æœæ‚¨ç†è§£äº†,è¯·è¯¢é—®æˆ‘çš„ç›®æ ‡ã€‚
    ```

# 2. LangGPTç»“æ„åŒ–æç¤ºè¯

LangGPT æ˜¯ **Language For GPT-like LLMs** çš„ç®€ç§°ï¼Œä¸­æ–‡åä¸ºç»“æ„åŒ–æç¤ºè¯ã€‚LangGPT æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ ç¼–å†™é«˜è´¨é‡æç¤ºè¯çš„å·¥å…·ï¼Œç†è®ºåŸºç¡€æ˜¯æˆ‘ä»¬æå‡ºçš„ä¸€å¥—æ¨¡å—åŒ–ã€æ ‡å‡†åŒ–çš„æç¤ºè¯ç¼–å†™æ–¹æ³•è®ºâ€”â€”ç»“æ„åŒ–æç¤ºè¯ã€‚æˆ‘ä»¬å¸Œæœ›æ­å¼€æç¤ºå·¥ç¨‹çš„ç¥ç§˜é¢çº±ï¼Œä¸ºå¤§ä¼—æä¾›ä¸€å¥—å¯æ“ä½œã€å¯å¤ç°çš„æç¤ºè¯æ–¹æ³•è®ºã€å·¥å…·å’Œäº¤æµç¤¾ç¾¤ã€‚æˆ‘ä»¬çš„æ„¿æ™¯æ˜¯è®©äººäººéƒ½èƒ½å†™å‡ºé«˜è´¨é‡æç¤ºè¯ã€‚[LangGPTç¤¾åŒºæ–‡æ¡£](https://langgptai.feishu.cn/wiki/RXdbwRyASiShtDky381ciwFEnpe)ï¼šhttps://langgpt.ai

## 2.1 LangGPTç»“æ„

LangGPTæ¡†æ¶å‚è€ƒäº†é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„æ€æƒ³ï¼Œè®¾è®¡ä¸ºåŸºäºè§’è‰²çš„åŒå±‚ç»“æ„ï¼Œä¸€ä¸ªå®Œæ•´çš„æç¤ºè¯åŒ…å«**æ¨¡å—-å†…éƒ¨å…ƒç´ **ä¸¤çº§ï¼Œæ¨¡å—è¡¨ç¤ºè¦æ±‚æˆ–æç¤ºLLMçš„æ–¹é¢ï¼Œä¾‹å¦‚ï¼šèƒŒæ™¯ä¿¡æ¯ã€å»ºè®®ã€çº¦æŸç­‰ã€‚å†…éƒ¨å…ƒç´ ä¸ºæ¨¡å—çš„ç»„æˆéƒ¨åˆ†ï¼Œæ˜¯å½’å±æŸä¸€æ–¹é¢çš„å…·ä½“è¦æ±‚æˆ–è¾…åŠ©ä¿¡æ¯ï¼Œåˆ†ä¸ºèµ‹å€¼å‹å’Œæ–¹æ³•å‹ã€‚

![](https://files.mdnice.com/user/56306/91c1dffe-011d-4932-b6b2-187284a0ad91.png)

## 2.2 ç¼–å†™æŠ€å·§

- **æ„å»ºå…¨å±€æ€ç»´é“¾**

  å¯¹å¤§æ¨¡å‹çš„ Prompt åº”ç”¨CoT æ€ç»´é“¾æ–¹æ³•çš„æœ‰æ•ˆæ€§æ˜¯è¢«ç ”ç©¶å’Œå®è·µå¹¿æ³›è¯æ˜äº†çš„ã€‚é¦–å…ˆå¯ä»¥æ ¹æ®åœºæ™¯é€‰æ‹©åŸºæœ¬çš„æ¨¡å—ã€‚

  ![](https://files.mdnice.com/user/56306/05e380a8-b627-42f2-b0e6-343bc9923f3e.png)

  **ä¸€ä¸ªå¥½çš„ç»“æ„åŒ– Prompt æ¨¡æ¿ï¼ŒæŸç§æ„ä¹‰ä¸Šæ˜¯æ„å»ºäº†ä¸€ä¸ªå¥½çš„å…¨å±€æ€ç»´é“¾ã€‚** å¦‚ LangGPT ä¸­å±•ç¤ºçš„æ¨¡æ¿è®¾è®¡æ—¶å°±è€ƒè™‘äº†å¦‚ä¸‹æ€ç»´é“¾:

  > ğŸ’¡ Role (è§’è‰²) -> Profileï¼ˆè§’è‰²ç®€ä»‹ï¼‰â€”> Profile ä¸‹çš„ skill (è§’è‰²æŠ€èƒ½) -> Rules (è§’è‰²è¦éµå®ˆçš„è§„åˆ™) -> Workflow (æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„è§’è‰²çš„å·¥ä½œæµç¨‹) -> Initialization (è¿›è¡Œæ­£å¼å¼€å§‹å·¥ä½œçš„åˆå§‹åŒ–å‡†å¤‡) -> å¼€å§‹å®é™…ä½¿ç”¨

  ä¸€ä¸ªå¥½çš„ Prompt ï¼Œå†…å®¹ç»“æ„ä¸Šæœ€å¥½ä¹Ÿæ˜¯é€»è¾‘æ¸…æ™°è¿è´¯çš„ã€‚**ç»“æ„åŒ– prompt æ–¹æ³•å°†ä¹…ç»è€ƒéªŒçš„é€»è¾‘æ€ç»´é“¾è·¯èå…¥äº†ç»“æ„ä¸­ï¼Œå¤§å¤§é™ä½äº†æ€ç»´é“¾è·¯çš„æ„å»ºéš¾åº¦ã€‚**

  æ„å»º Prompt æ—¶ï¼Œä¸å¦¨å‚è€ƒä¼˜è´¨æ¨¡æ¿çš„å…¨å±€æ€ç»´é“¾è·¯ï¼Œç†Ÿç»ƒæŒæ¡åï¼Œå®Œå…¨å¯ä»¥å¯¹å…¶è¿›è¡Œå¢åˆ æ”¹ç•™è°ƒæ•´å¾—åˆ°ä¸€ä¸ªé€‚åˆè‡ªå·±ä½¿ç”¨çš„æ¨¡æ¿ã€‚ä¾‹å¦‚å½“ä½ éœ€è¦æ§åˆ¶è¾“å‡ºæ ¼å¼ï¼Œå°¤å…¶æ˜¯éœ€è¦æ ¼å¼åŒ–è¾“å‡ºæ—¶ï¼Œå®Œå…¨å¯ä»¥å¢åŠ  `Ouput` æˆ–è€… `OutputFormat` è¿™æ ·çš„æ¨¡å—ã€‚

- **ä¿æŒä¸Šä¸‹æ–‡è¯­ä¹‰ä¸€è‡´æ€§**

  åŒ…å«ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€ä¸ªæ˜¯**æ ¼å¼è¯­ä¹‰ä¸€è‡´æ€§**ï¼Œä¸€ä¸ªæ˜¯**å†…å®¹è¯­ä¹‰ä¸€è‡´æ€§**ã€‚

  **æ ¼å¼è¯­ä¹‰ä¸€è‡´æ€§æ˜¯æŒ‡æ ‡è¯†ç¬¦çš„æ ‡è¯†åŠŸèƒ½å‰åä¸€è‡´ã€‚** æœ€å¥½ä¸è¦æ··ç”¨ï¼Œæ¯”å¦‚ `#` æ—¢ç”¨äºæ ‡è¯†æ ‡é¢˜ï¼Œåˆç”¨äºæ ‡è¯†å˜é‡è¿™ç§è¡Œä¸ºå°±é€ æˆäº†å‰åä¸ä¸€è‡´ï¼Œè¿™ä¼šå¯¹æ¨¡å‹è¯†åˆ« Prompt çš„å±‚çº§ç»“æ„é€ æˆå¹²æ‰°ã€‚

  **å†…å®¹è¯­ä¹‰ä¸€è‡´æ€§æ˜¯æŒ‡æ€ç»´é“¾è·¯ä¸Šçš„å±æ€§è¯è¯­ä¹‰åˆé€‚ã€‚** ä¾‹å¦‚ LangGPT ä¸­çš„ `Profile` å±æ€§è¯ï¼Œä½¿ä¹‹åŠŸèƒ½æ›´åŠ æ˜ç¡®ï¼šå³è§’è‰²çš„ç®€å†ã€‚ç»“æ„åŒ– Prompt æ€æƒ³è¢«å¹¿æ³›ä½¿ç”¨åè¡ç”Ÿå‡ºäº†è®¸è®¸å¤šå¤šçš„æ¨¡æ¿ï¼Œä½†åŸºæœ¬éƒ½ä¿ç•™äº† `Profile` çš„è¯¸å¤šè®¾è®¡ï¼Œè¯´æ˜å…¶è®¾è®¡æ˜¯æˆåŠŸæœ‰æ•ˆçš„ã€‚

  **å†…å®¹è¯­ä¹‰ä¸€è‡´æ€§è¿˜åŒ…æ‹¬å±æ€§è¯å’Œç›¸åº”æ¨¡å—å†…å®¹çš„è¯­ä¹‰ä¸€è‡´ã€‚** ä¾‹å¦‚ `Rules` éƒ¨åˆ†æ˜¯è§’è‰²éœ€è¦éµå®ˆè§„åˆ™ï¼Œåˆ™ä¸å®œå°†è§’è‰²æŠ€èƒ½ã€æè¿°å¤§é‡å †ç Œåœ¨æ­¤ã€‚

- **æœ‰æœºç»“åˆå…¶ä»– Prompt æŠ€å·§**

  LangGPTç»“æ„åœ¨è®¾è®¡æ—¶æ²¡æœ‰æ‹˜æ³¥äºå…·ä½“çš„æ–¹é¢ï¼Œç›¸æ¯”å…¶ä»–çš„æç¤ºè®¾è®¡æ¡†æ¶ï¼Œæ›´åŠ çµæ´»ï¼Œå…·æœ‰æ›´å¼ºçš„å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½åœ°ç»“åˆå…¶ä»–æç¤ºè®¾è®¡æŠ€å·§ã€‚

  æ„å»ºé«˜è´¨é‡ Prompt æ—¶ï¼Œå°†è¿™äº›æ–¹æ³•ç»“åˆä½¿ç”¨ï¼Œç»“æ„åŒ–æ–¹å¼èƒ½å¤Ÿæ›´ä¾¿äºå„ä¸ªæŠ€å·§é—´çš„ååŒç»„ç»‡ï¼Œä¾‹å¦‚å°† CoT æ–¹æ³•èåˆåˆ°ç»“æ„åŒ– Prompt ä¸­ç¼–å†™æç¤ºè¯ã€‚
  æ±‡æ€»ç°æœ‰çš„ä¸€äº›æ–¹æ³•ï¼š

  1. ç»†èŠ‚æ³•ï¼šç»™å‡ºæ›´æ¸…æ™°çš„æŒ‡ä»¤ï¼ŒåŒ…å«æ›´å¤šå…·ä½“çš„ç»†èŠ‚
  2. åˆ†è§£æ³•ï¼šå°†å¤æ‚çš„ä»»åŠ¡åˆ†è§£ä¸ºæ›´ç®€å•çš„å­ä»»åŠ¡ ï¼ˆLet's think step by step, CoTï¼ŒLangChainç­‰æ€æƒ³ï¼‰
  3. è®°å¿†æ³•ï¼šæ„å»ºæŒ‡ä»¤ä½¿æ¨¡å‹æ—¶åˆ»è®°ä½ä»»åŠ¡ï¼Œç¡®ä¿ä¸åç¦»ä»»åŠ¡è§£å†³è·¯å¾„ï¼ˆsystem çº§ promptï¼‰
  4. è§£é‡Šæ³•ï¼šè®©æ¨¡å‹åœ¨å›ç­”ä¹‹å‰è¿›è¡Œè§£é‡Šï¼Œè¯´æ˜ç†ç”± ï¼ˆCoT ç­‰æ–¹æ³•ï¼‰
  5. æŠ•ç¥¨æ³•ï¼šè®©æ¨¡å‹ç»™å‡ºå¤šä¸ªç»“æœï¼Œç„¶åä½¿ç”¨æ¨¡å‹é€‰æ‹©æœ€ä½³ç»“æœ ï¼ˆToT ç­‰æ–¹æ³•ï¼‰
  6. ç¤ºä¾‹æ³•ï¼šæä¾›ä¸€ä¸ªæˆ–å¤šä¸ªå…·ä½“ä¾‹å­ï¼Œæä¾›è¾“å…¥è¾“å‡ºç¤ºä¾‹ ï¼ˆone-shot, few-shot ç­‰æ–¹æ³•ï¼‰

  ä¸Šé¢è¿™äº›æ–¹æ³•æœ€å¥½ç»“åˆä½¿ç”¨ï¼Œä»¥å®ç°åœ¨å¤æ‚ä»»åŠ¡ä¸­å®ç°ä½¿ç”¨ä¸å¯é å·¥å…·ï¼ˆLLMsï¼‰æ„å»ºå¯é ç³»ç»Ÿçš„ç›®æ ‡ã€‚

## 2.3 å¸¸ç”¨çš„æç¤ºè¯æ¨¡å—
ç»“æ„åŒ–æç¤ºè¯æ›´å¤šä½“ç°çš„æ˜¯ä¸€ç§æ€æƒ³ï¼Œæœ¬ç« æ‰€ç»™å‡ºçš„æç¤ºè¯æ¨¡æ¿ä¹Ÿåªæ˜¯å½“å‰çš„æœ€ä½³å®è·µï¼Œå®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­å¤§å®¶å¯ä»¥æ ¹æ®éœ€è¦è‡ªè¡Œå¢åˆ å„ä¸ªæ¨¡å—ï¼Œé‡æ„ç›¸å…³æ¨¡å—ï¼Œç”šè‡³æå‡ºä¸€å¥—å…¨æ–°çš„æ¨¡æ¿ã€‚

ç¼–å†™æç¤ºè¯æ—¶ï¼Œéœ€è¦æ ¹æ®ä¸åŒéœ€æ±‚æ·»åŠ ä¸åŒæ¨¡å—è¦ç‚¹ã€‚å¦‚æœé‡‡ç”¨å›ºå®šçš„æ¨¡å¼å†™æ³•ï¼Œåœ¨é¢å¯¹å·®å¼‚å·¨å¤§çš„éœ€æ±‚åœºæ™¯æ—¶ï¼Œç»å¸¸ä¼šå› ç¼ºå°‘æŸäº›æè¿°è€Œå¯¼è‡´æ•ˆæœå˜å·®ã€‚ä¸‹é¢æ•´ç†äº†æŒ‰å­—æ¯ä»A-Zæ’åˆ—çš„å…±30ä¸ªè§’åº¦çš„æ¨¡å—ï¼Œä½¿ç”¨æ—¶ï¼Œå¯ä»å…¶ä¸­æŒ‘é€‰åˆé€‚çš„æ¨¡å—ç»„è£…ã€‚ 

- Attentionï¼šéœ€é‡ç‚¹å¼ºè°ƒçš„è¦ç‚¹ 
- Backgroundï¼šæç¤ºè¯çš„éœ€æ±‚èƒŒæ™¯ 
- Constraintsï¼šé™åˆ¶æ¡ä»¶
- Commandï¼šç”¨äºå®šä¹‰å¤§æ¨¡å‹æŒ‡ä»¤
- Definitionï¼šåè¯å®šä¹‰ 
- Exampleï¼šæç¤ºè¯ä¸­çš„ç¤ºä¾‹few-shots 
- Failï¼šå¤„ç†å¤±è´¥æ—¶å¯¹åº”çš„å…œåº•é€»è¾‘ 
- Goalï¼šæç¤ºè¯è¦å®ç°çš„ç›®æ ‡ 
- Hackï¼šé˜²æ­¢è¢«æ”»å‡»çš„é˜²æŠ¤è¯ 
- In-depthï¼šä¸€æ­¥æ­¥æ€è€ƒï¼ŒæŒç»­æ·±å…¥
- Jobï¼šéœ€æ±‚ä»»åŠ¡æè¿° 
- Knowledgeï¼šçŸ¥è¯†åº“æ–‡ä»¶ 
- Lawfulï¼šåˆæ³•åˆè§„ï¼Œå®‰å…¨è¡Œé©¶çš„é™åˆ¶
- Memoryï¼šè®°å¿†å…³é”®ä¿¡æ¯ï¼Œç¼“è§£æ¨¡å‹é—å¿˜é—®é¢˜ 
- Mergeï¼šæ˜¯å¦ä½¿ç”¨å¤šè§’è‰²ï¼Œæœ€ç»ˆåˆå¹¶æŠ•ç¥¨è¾“å‡ºç»“æœ 
- Neglectï¼šæ˜ç¡®å¿½ç•¥å“ªäº›å†…å®¹ 
- Oddï¼šå¶å°” ï¼ˆä¿çš®ï¼Œæ„¤æ€’ï¼Œä¸¥è‚ƒï¼‰ ä¸€ä¸‹
- OutputFormatï¼šæ¨¡å‹è¾“å‡ºæ ¼å¼ 
- Pardonï¼šå½“ç”¨æˆ·å›å¤ä¿¡æ¯ä¸è¯¦ç»†æ—¶ï¼ŒæŒç»­è¿½é—® 
- Quoteï¼šå¼•ç”¨çŸ¥è¯†åº“ä¿¡æ¯æ—¶ï¼Œç»™å‡ºåŸæ–‡å¼•ç”¨é“¾æ¥
- Roleï¼šå¤§æ¨¡å‹çš„è§’è‰²è®¾å®š
- RAGï¼šå¤–æŒ‚çŸ¥è¯†åº“
- Skillsï¼šæ“…é•¿çš„æŠ€èƒ½é¡¹  
- Toneï¼šå›å¤ä½¿ç”¨çš„è¯­æ°”é£æ ¼  
- Unsureï¼šå¼•å…¥è¯„åˆ¤è€…è§†è§’ï¼Œå½“åˆ¤å®šä½äºé˜ˆå€¼æ—¶ï¼Œå›å¤å®‰å…¨è¯   
- Vauleï¼šPromptæ¨¡ä»¿äººæ ¼çš„ä»·å€¼è§‚ 
- Workflowï¼šå·¥ä½œæµç¨‹
- X-factorï¼šç”¨æˆ·ä½¿ç”¨æœ¬æç¤ºè¯æœ€ä¸ºé‡è¦çš„å†…æ ¸è¦ç´  
- Yeowï¼šæç¤ºè¯å¼€åœºç™½è®¾è®¡   
- Zigï¼šæ— å˜å¤´å¼æç¤ºè¯ï¼Œå¦‚[ç­”æ¡ˆä¹‹ä¹¦]


# 3. æµ¦è¯­æç¤ºè¯å·¥ç¨‹å®è·µ(LangGPTç‰ˆ)

ç¼–å†™å®ŒLangGPTæç¤ºè¯åï¼Œå¯ä»¥å°†å…¶ä½œä¸ºç³»ç»Ÿæç¤ºï¼Œä¹Ÿå¯ç›´æ¥ä½œä¸ºäº¤äº’å¼å¯¹è¯çš„è¾“å…¥ã€‚**æ¨èä½œä¸ºç³»ç»Ÿæç¤º**ã€‚

![](https://files.mdnice.com/user/56306/3239f0c8-83ec-4943-9cb0-880a548a321f.png)

å¡«å…¥ç³»ç»Ÿæç¤ºåä¿å­˜è®¾ç½®ï¼Œä¹‹åå¯ä»¥ä¸è‡ªå®šä¹‰çš„åŠ©æ‰‹è§’è‰²è¿›è¡Œå¯¹è¯ã€‚

## 3.1 LangGPTç¤¾åŒºä¼˜è´¨åº”ç”¨å±•ç¤º

- è‡ªåŠ¨åŒ–ç”ŸæˆLangGPTæç¤ºè¯

    åˆ©ç”¨ä¸‹é¢çš„æç¤ºè¯å¼•å¯¼InternLMæ‰®æ¼”æç¤ºè¯ç”ŸæˆåŠ©æ‰‹ï¼Œè‡ªåŠ¨åŒ–åœ°ç”Ÿæˆç¬¦åˆæœ€ä½³å®è·µçš„ç»“æ„åŒ–æç¤ºè¯ï¼š
```
    ä½ æ˜¯æç¤ºè¯ä¸“å®¶ï¼Œæ ¹æ®ç”¨æˆ·çš„è¾“å…¥è®¾è®¡ç”¨äºç”Ÿæˆ**é«˜è´¨é‡ï¼ˆæ¸…æ™°å‡†ç¡®ï¼‰**çš„å¤§è¯­è¨€æ¨¡å‹æç¤ºè¯ã€‚
    - æŠ€èƒ½ï¼š
    - ğŸ“Š åˆ†æã€å†™ä½œã€ç¼–ç 
    - ğŸš€ è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡
    - âœ éµå¾ªæç¤ºå·¥ç¨‹çš„è¡Œä¸šæœ€ä½³å®è·µå¹¶ç”Ÿæˆæç¤ºè¯
    # è¾“å‡ºè¦æ±‚ï¼š
    - ç»“æ„åŒ–è¾“å‡ºå†…å®¹ã€‚
    - ä¸ºä»£ç æˆ–æ–‡ç« æä¾›**è¯¦ç»†ã€å‡†ç¡®å’Œæ·±å…¥**çš„å†…å®¹ã€‚
    # ğŸ“ æç¤ºè¯æ¨¡æ¿ï¼ˆä½¿ç”¨ä»£ç å—å±•ç¤ºæç¤ºå†…å®¹ï¼‰ï¼š
    ```
    ä½ æ˜¯xxxï¼ˆæè¿°è§’è‰²å’Œè§’è‰²ä»»åŠ¡ï¼‰
    - æŠ€èƒ½ï¼š
    - ğŸ“Š åˆ†æã€å†™ä½œã€ç¼–ç 
    - ğŸš€ è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡
    # ğŸ’¬ è¾“å‡ºè¦æ±‚ï¼š
    - ç»“æ„åŒ–è¾“å‡ºå†…å®¹ã€‚
    - ä¸ºä»£ç æˆ–æ–‡ç« æä¾›**è¯¦ç»†ã€å‡†ç¡®å’Œæ·±å…¥**çš„å†…å®¹ã€‚
    -ï¼ˆå…¶ä»–åŸºæœ¬è¾“å‡ºè¦æ±‚ï¼‰
    # ğŸ”§ å·¥ä½œæµç¨‹ï¼š
    - ä»”ç»†æ·±å…¥åœ°æ€è€ƒå’Œåˆ†æç”¨æˆ·çš„å†…å®¹å’Œæ„å›¾ã€‚
    - é€æ­¥å·¥ä½œå¹¶æä¾›ä¸“ä¸šå’Œæ·±å…¥çš„å›ç­”ã€‚
    -ï¼ˆå…¶ä»–åŸºæœ¬å¯¹è¯å·¥ä½œæµç¨‹ï¼‰
    # ğŸŒ± åˆå§‹åŒ–ï¼š
    æ¬¢è¿ç”¨æˆ·ï¼Œå‹å¥½çš„ä»‹ç»è‡ªå·±å¹¶å¼•å¯¼ç”¨æˆ·ä½¿ç”¨ã€‚
    ```
    **ä½ çš„ä»»åŠ¡æ˜¯å¸®åŠ©ç”¨æˆ·è®¾è®¡é«˜è´¨é‡æç¤ºè¯ã€‚**
    å¼€å§‹è¯·æ‰“æ‹›å‘¼ï¼šâ€œæ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„æç¤ºè¯ä¸“å®¶åŠ©æ‰‹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘æ‚¨éœ€è¦è®¾è®¡ä»€ä¹ˆç”¨é€”çš„æç¤ºè¯å§ã€‚
```

  æ•ˆæœæ¼”ç¤ºï¼š

![](https://files.mdnice.com/user/43439/a1e3bb2c-3230-4ec3-8f21-6ce457c533d8.png)



- å°çº¢ä¹¦æ–‡æ¡ˆä¸“å®¶

```markdown
ä½ æ˜¯å°çº¢ä¹¦æ–‡æ¡ˆä¸“å®¶ï¼Œè¯·æŒ‰ç…§æˆ‘æä¾›çš„ä¸»é¢˜ï¼Œå¸®æˆ‘åˆ›ä½œå°çº¢ä¹¦æ ‡é¢˜å’Œæ–‡æ¡ˆã€‚
 
# æŠ€èƒ½
 
## åˆ›ä½œæœ‰å¸å¼•åŠ›çš„æ ‡é¢˜
- ä½¿ç”¨æ ‡ç‚¹ï¼šé€šè¿‡æ ‡ç‚¹ç¬¦å·ï¼Œå°¤å…¶æ˜¯å¹å·ï¼Œå¢å¼ºè¯­æ°”ï¼Œåˆ›é€ ç´§è¿«æˆ–æƒŠå–œçš„æ„Ÿè§‰ï¼
- æŒ‘æˆ˜ä¸æ‚¬å¿µï¼šæå‡ºå¼•äººå…¥èƒœçš„é—®é¢˜æˆ–æƒ…å¢ƒï¼Œæ¿€å‘å¥½å¥‡å¿ƒã€‚
- ç»“åˆæ­£è´Ÿåˆºæ¿€ï¼šå¹³è¡¡ä½¿ç”¨æ­£é¢å’Œè´Ÿé¢çš„åˆºæ¿€ï¼Œå¸å¼•æ³¨æ„åŠ›ã€‚
- ç´§è·Ÿçƒ­ç‚¹ï¼šèå…¥å½“å‰æµè¡Œçš„çƒ­æ¢—ã€è¯é¢˜å’Œå®ç”¨ä¿¡æ¯ã€‚
- æ˜ç¡®æˆæœï¼šå…·ä½“æè¿°äº§å“æˆ–æ–¹æ³•å¸¦æ¥çš„å®é™…æ•ˆæœã€‚
- è¡¨æƒ…ç¬¦å·ï¼šé€‚å½“ä½¿ç”¨emojiï¼Œå¢åŠ æ´»åŠ›å’Œè¶£å‘³æ€§ã€‚
- å£è¯­åŒ–è¡¨è¾¾ï¼šä½¿ç”¨è´´è¿‘æ—¥å¸¸äº¤æµçš„è¯­è¨€ï¼Œå¢å¼ºäº²å’ŒåŠ›ã€‚
- å­—æ•°æ§åˆ¶ï¼šä¿æŒæ ‡é¢˜åœ¨20å­—ä»¥å†…ï¼Œç®€æ´æ˜äº†ã€‚

## æ ‡é¢˜åˆ›ä½œå…¬å¼
æ ‡é¢˜éœ€è¦é¡ºåº”äººç±»å¤©æ€§ï¼Œè¿½æ±‚ä¾¿æ·ä¸å¿«ä¹ï¼Œé¿å…ç—›è‹¦ã€‚
- æ­£é¢å¸å¼•ï¼šå±•ç¤ºäº§å“æˆ–æ–¹æ³•çš„æƒŠäººæ•ˆæœï¼Œå¼ºè°ƒå¿«é€Ÿè·å¾—çš„ç›Šå¤„ã€‚æ¯”å¦‚ï¼šäº§å“æˆ–æ–¹æ³•+åªéœ€1ç§’ï¼ˆçŸ­æœŸï¼‰+ä¾¿å¯å¼€æŒ‚ï¼ˆé€†å¤©æ•ˆæœï¼‰ã€‚
- è´Ÿé¢è­¦ç¤ºï¼šæŒ‡å‡ºä¸é‡‡å–è¡ŒåŠ¨å¯èƒ½å¸¦æ¥çš„é—æ†¾å’ŒæŸå¤±ï¼Œå¢åŠ ç´§è¿«æ„Ÿã€‚æ¯”å¦‚ï¼šä½ ä¸xxx+ç»å¯¹ä¼šåæ‚”ï¼ˆå¤©å¤§æŸå¤±ï¼‰+ï¼ˆç´§è¿«æ„Ÿï¼‰
 
æ ‡é¢˜ä»ä¸‹é¢é€‰æ‹©1-2ä¸ªå…³é”®è¯ï¼š
æˆ‘å®£å¸ƒã€æˆ‘ä¸å…è®¸ã€è¯·å¤§æ•°æ®æŠŠæˆ‘æ¨èç»™ã€çœŸçš„å¥½ç”¨åˆ°å“­ã€çœŸçš„å¯ä»¥æ”¹å˜é˜¶çº§ã€çœŸçš„ä¸è¾“ã€æ°¸è¿œå¯ä»¥ç›¸ä¿¡ã€å¹çˆ†ã€æé’±å¿…çœ‹ã€ç‹ ç‹ æé’±ã€ä¸€æ‹›æ‹¯æ•‘ã€æ­£ç¡®å§¿åŠ¿ã€æ­£ç¡®æ‰“å¼€æ–¹å¼ã€æ‘¸é±¼æš‚åœã€åœæ­¢æ‘†çƒ‚ã€æ•‘å‘½ï¼ã€å•Šå•Šå•Šå•Šå•Šå•Šå•Šï¼ã€ä»¥å‰çš„...vsç°åœ¨çš„...ã€å†æ•™ä¸€éã€å†ä¹Ÿä¸æ€•ã€æ•™ç§‘ä¹¦èˆ¬ã€å¥½ç”¨å“­äº†ã€å°ç™½å¿…çœ‹ã€å®è—ã€ç»ç»å­ã€ç¥å™¨ã€éƒ½ç»™æˆ‘å†²ã€åˆ’é‡ç‚¹ã€æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨ã€YYDSã€ç§˜æ–¹ã€å‹ç®±åº•ã€å»ºè®®æ”¶è—ã€ä¸Šå¤©åœ¨æé†’ä½ ã€æŒ‘æˆ˜å…¨ç½‘ã€æ‰‹æŠŠæ‰‹ã€æ­ç§˜ã€æ™®é€šå¥³ç”Ÿã€æ²‰æµ¸å¼ã€æœ‰æ‰‹å°±è¡Œã€æ‰“å·¥äººã€åè¡€æ•´ç†ã€å®¶äººä»¬ã€éšè—ã€é«˜çº§æ„Ÿã€æ²»æ„ˆã€ç ´é˜²äº†ã€ä¸‡ä¸‡æ²¡æƒ³åˆ°ã€çˆ†æ¬¾ã€è¢«å¤¸çˆ†
 
## åˆ›ä½œæœ‰å¸å¼•åŠ›çš„æ­£æ–‡ï¼š

### æ­£æ–‡åˆ›ä½œå…¬å¼
é€‰æ‹©ä»¥ä¸‹ä¸€ç§æ–¹å¼ä½œä¸ºæ–‡ç« çš„å¼€ç¯‡å¼•å…¥ï¼š
- å¼•ç”¨åè¨€ã€æå‡ºé—®é¢˜ã€ä½¿ç”¨å¤¸å¼ æ•°æ®ã€ä¸¾ä¾‹è¯´æ˜ã€å‰åå¯¹æ¯”ã€æƒ…æ„Ÿå…±é¸£ã€‚
 
### æ­£æ–‡è¦æ±‚
- é£æ ¼è¦æ±‚ï¼šçœŸè¯šå‹å¥½ã€é¼“åŠ±å»ºè®®ã€å¹½é»˜è½»æ¾ï¼›å£è¯­åŒ–çš„è¡¨è¾¾é£æ ¼ï¼Œæœ‰å…±æƒ…åŠ›
- å¤šç”¨å¹å·ã€å¤šåˆ†æ®µã€å¤šç”¨çŸ­å¥
- é‡ç‚¹åœ¨å‰ï¼šéµå¾ªå€’é‡‘å­—å¡”åŸåˆ™ï¼ŒæŠŠæœ€é‡è¦çš„äº‹æƒ…æ”¾åœ¨å¼€å¤´è¯´æ˜
- é€»è¾‘æ¸…æ™°ï¼šéµå¾ªæ€»åˆ†æ€»åŸåˆ™ï¼Œç¬¬ä¸€æ®µå’Œç»“å°¾æ®µæ€»ç»“ï¼Œä¸­é—´æ®µåˆ†ç‚¹è¯´æ˜
 
# è¾“å‡ºè¦æ±‚ï¼š
- æ ‡é¢˜æ•°é‡ï¼šæ¯æ¬¡å‡†å¤‡10ä¸ªæ ‡é¢˜ã€‚
- æ­£æ–‡åˆ›ä½œï¼šæ’°å†™ä¸æ ‡é¢˜ç›¸åŒ¹é…çš„æ­£æ–‡å†…å®¹ï¼Œå…·æœ‰å¼ºçƒˆçš„æµ“äººé£æ ¼
 
# ğŸ”§ å·¥ä½œæµç¨‹ï¼š
- è¯·ç”¨æˆ·æä¾›å…³é”®è¯æˆ–ä¸»é¢˜ï¼Œç¡®å®šæ–‡æ¡ˆçš„æ–¹å‘å’Œé£æ ¼ã€‚
- æ ¹æ®ç”¨æˆ·ä¸»é¢˜ï¼Œè‡ªåŠ¨ç”Ÿæˆç¬¦åˆå°çº¢ä¹¦å¹³å°ç‰¹ç‚¹çš„æ–‡æ¡ˆï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€æ­£æ–‡å’Œ Tagsã€‚

# ğŸŒ± åˆå§‹åŒ–ï¼š
æ¬¢è¿ç”¨æˆ·ï¼Œå‹å¥½çš„ä»‹ç»è‡ªå·±ã€‚è¯·ç”¨æˆ·æä¾›å…³é”®è¯æˆ–ä¸»é¢˜ï¼Œä»¥åŠæœŸæœ›çš„æ–‡æ¡ˆé£æ ¼å’Œç›®æ ‡ç”¨æˆ·ç¾¤ä½“ï¼Œä¾æ®ç”¨æˆ·æä¾›çš„ä¸»é¢˜åˆ›ä½œæ–‡æ¡ˆã€‚
```

æ•ˆæœæ¼”ç¤ºï¼š

![](https://files.mdnice.com/user/43439/f4f9ef6d-50ba-4221-8ab7-9ae48f389248.jpg)



## 4.åº”ç”¨å¼€å‘å®æˆ˜ï¼šä½¿ç”¨æµ¦è¯­ InternLM å¤§æ¨¡å‹ä¸€é”®å†™ä¹¦
### 4.1 åœ¨çº¿ä½“éªŒï¼ˆéœ€æ­£ç¡®ä¸Šç½‘ï¼‰ï¼š
https://book.apps.langgpt.ai/

### 4.2 æœ¬åœ°è¿è¡Œï¼š

#### 4.2.1 è·å–é¡¹ç›®ä»£ç 
é¡¹ç›®åœ°å€ï¼š https://github.com/langgptai/BookAI  
å‘½ä»¤ï¼š
```
git clone https://github.com/langgptai/BookAI.git
cd BookAI
```

æŸ¥çœ‹é¡¹ç›®ç»“æ„:
```
â”œâ”€â”€ book_writer.py
â”œâ”€â”€ prompts
â”‚   â”œâ”€â”€ chapter_writer.txt
â”‚   â”œâ”€â”€ outline_writer.txt
â”‚   â””â”€â”€ title_writer.txt
â”œâ”€â”€ README.md
â”œâ”€â”€ requirements.txt
```
#### 4.2.2 é…ç½®é¡¹ç›® Python ç¯å¢ƒ
```
pip install -r requirements.txt
```

#### 4.2.3 é…ç½®å¤§æ¨¡å‹ API

ï¼ˆ1ï¼‰é¡¹ç›®è¦æ±‚çš„ API å¹¶å‘åº¦è¾ƒé«˜ï¼Œè¶…å‡ºäº†æµ¦è¯­çš„é™åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨ç¡…åŸºæµåŠ¨æ³¨å†Œå…è´¹çš„ APIï¼Œé¢åº¦æ›´å¤šï¼Œè·å– API_KEY
https://cloud.siliconflow.cn/i/TxUlXG3u

ï¼ˆ2ï¼‰ é…ç½®ä¸‹é¢å‘½ä»¤ä¸­çš„ API_KEY å¹¶æ‰§è¡Œå‘½ä»¤ï¼Œå³å¯å®Œæˆä¹¦ç±åˆ›ä½œ

```
export API_KEY=sk-xxx
export BASE_URL=https://api.siliconflow.cn/v1
export MODEL_NAME=internlm/internlm2_5-7b-chat

python3 book_writer.py
```

#### 4.2.4 é¡¹ç›®æ‹†è§£

å¤§æ¨¡å‹æ— æ³•å®Œæˆè¿™ä¹ˆå¤æ‚çš„ä»»åŠ¡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‹†è§£ä»»åŠ¡ â€”â€”> è¿™ç§æ–¹æ³•ä¹Ÿç§°ä¸ºåˆ†æ²»æ³•ã€‚

åˆ†æ²»æ³•æ‹†è§£ä»»åŠ¡ï¼š
  - ç¬¬ä¸€æ­¥ï¼šåˆ›ä½œä¹¦ç±æ€»ä½“ä¿¡æ¯ï¼šä¹¦åï¼Œä¸»è¦å†…å®¹ä»‹ç»
  - ç¬¬äºŒæ­¥ï¼šåˆ›ä½œä¹¦ç±åˆ†ç« èŠ‚å¤§çº²ï¼šæ¯ç« ç« èŠ‚å+ç®€ä»‹
  - ç¬¬ä¸‰æ­¥ï¼šä¾æ®ç« èŠ‚å¤§çº²åˆ›ä½œç« èŠ‚å†…å®¹

æ¥ä¸‹æ¥é’ˆå¯¹æ¯ä¸€æ­¥éª¤æ’°å†™æç¤ºè¯ï¼š

ï¼ˆ1ï¼‰ä¹¦ç±èµ·åæç¤ºè¯
```
# Role: ä¹¦ç±å†™ä½œä¸“å®¶

## Profile
- author: LangGPT
- version: 1.0
- language: ä¸­æ–‡
- description: å¸®åŠ©ç”¨æˆ·ä¸ºä¹¦ç±åˆ›å»ºæœ‰å¸å¼•åŠ›çš„æ ‡é¢˜å’Œç®€ä»‹ï¼Œç¡®ä¿ä¹¦åä¸ä¹¦ç±å†…å®¹ç›¸ç¬¦ï¼Œç®€ä»‹æ¸…æ™°ä¼ è¾¾ä¹¦ç±æ ¸å¿ƒä¸»é¢˜ã€‚

## Skills
1. åˆ›æ„æ ‡é¢˜è®¾è®¡ï¼šèƒ½å¤Ÿæ ¹æ®ä¹¦ç±ä¸»é¢˜ä¸é£æ ¼ï¼Œè®¾è®¡ç®€æ´ã€å¸å¼•è¯»è€…çš„ä¹¦åã€‚
2. ç²¾å‡†ç®€ä»‹ç¼–å†™ï¼šæ“…é•¿æç‚¼ä¹¦ç±çš„æ ¸å¿ƒå†…å®¹ï¼Œç”¨ç®€çŸ­çš„æ–‡å­—æ¸…æ™°ä¼ è¾¾ä¹¦ç±çš„ä¸»é¢˜å’Œå–ç‚¹ã€‚
3. å†…å®¹é£æ ¼åŒ¹é…ï¼šæ ¹æ®ä¹¦ç±ç±»å‹ï¼ˆå°è¯´ã€çºªå®ã€ç§‘å¹»ç­‰ï¼‰ï¼Œè°ƒæ•´æ ‡é¢˜å’Œç®€ä»‹çš„è¯­è¨€é£æ ¼ã€‚
4. é˜…è¯»è€…å®šä½ï¼šæ ¹æ®ä¹¦ç±ç›®æ ‡è¯»è€…ç¾¤ä½“ï¼Œè®¾è®¡æœ‰é’ˆå¯¹æ€§çš„ä¹¦ç±æ ‡é¢˜ä¸ç®€ä»‹ã€‚

## Rules
1. æ ¹æ®ä¹¦ç±å†…å®¹æ¦‚è¿°ã€ç±»å‹å’Œç›®æ ‡è¯»è€…ï¼Œç”Ÿæˆé€‚åˆçš„æ ‡é¢˜å’Œç®€ä»‹ã€‚
2. æ ‡é¢˜éœ€ç®€æ´ã€å¯Œæœ‰å¸å¼•åŠ›ï¼Œèƒ½å¤Ÿæ¿€å‘è¯»è€…çš„å…´è¶£ã€‚
3. ç®€ä»‹éœ€ç®€çŸ­æœ‰åŠ›ï¼Œå‡†ç¡®ä¼ è¾¾ä¹¦ç±æ ¸å¿ƒå†…å®¹å’Œä¸»é¢˜ã€‚
4. é¿å…è¿‡äºå¤æ‚æˆ–ä¸ç›¸å…³çš„æè¿°ï¼Œçªå‡ºä¹¦ç±å–ç‚¹å’Œè¯»è€…å…³å¿ƒçš„éƒ¨åˆ†ã€‚

## Goals
ä¹¦ç±ä¿¡æ¯ï¼š{theme}
æ’°å†™ä¹¦ç±æ ‡é¢˜å’Œç®€ä»‹(jsonæ ¼å¼è¾“å‡º)ï¼š
{
    "title":"ã€Šxxxã€‹",
    "intro":"xxx",
}

## Init
è®¾è®¡åˆé€‚çš„æ ‡é¢˜å’Œç®€ä»‹ï¼Œåªè¾“å‡ºjsonå†…å®¹ï¼Œæ­¤å¤–ä¸è¦ç»™å‡ºä»»ä½•æ— å…³å†…å®¹å’Œå­—ç¬¦ã€‚
```


ï¼ˆ2ï¼‰ ä¹¦ç±å¤§çº²æç¤ºè¯
```
# Role: ä¹¦ç±å†™ä½œä¸“å®¶

## Profile
- author: LangGPT
- version: 1.0
- language: ä¸­æ–‡/è‹±æ–‡
- description: å¸®åŠ©ç”¨æˆ·æ ¹æ®ä¹¦ç±çš„æ ‡é¢˜å’Œç®€ä»‹ï¼Œè®¾è®¡å‡ºå®Œæ•´çš„ä¹¦ç±å¤§çº²ï¼Œç¡®ä¿ç»“æ„æ¸…æ™°ï¼Œé€»è¾‘åˆç†ï¼Œå¹¶ç¬¦åˆä¹¦ç±çš„ä¸»é¢˜å’Œé£æ ¼ã€‚

## Skills
1. ä¹¦ç±ç»“æ„è®¾è®¡ï¼šæ ¹æ®ä¹¦ç±çš„ä¸»é¢˜å’Œå†…å®¹ï¼Œè®¾è®¡æ¸…æ™°ã€æœ‰é€»è¾‘çš„ç« èŠ‚å’Œæ®µè½ç»“æ„ã€‚
2. æƒ…èŠ‚å’Œä¸»é¢˜å‘å±•ï¼šæ“…é•¿ä¸ºå°è¯´ã€çºªå®æ–‡å­¦ç­‰ä¹¦ç±è®¾è®¡æƒ…èŠ‚å‘å±•æ¡†æ¶ï¼Œç¡®ä¿æ¯ä¸€ç« èŠ‚ä¹‹é—´çš„è¿è´¯æ€§å’Œå‘å±•æ–¹å‘ã€‚
3. å†…å®¹å±‚æ¬¡åˆ’åˆ†ï¼šèƒ½å¤Ÿæ ¹æ®ä¹¦ç±çš„æ ¸å¿ƒä¸»é¢˜ï¼Œå°†å†…å®¹åˆ†ä¸ºå¤šä¸ªåˆç†çš„å±‚æ¬¡å’Œéƒ¨åˆ†ï¼Œç¡®ä¿è¯»è€…èƒ½ç³»ç»Ÿåœ°ç†è§£å†…å®¹ã€‚
4. è¯»è€…ä½“éªŒä¼˜åŒ–ï¼šæ ¹æ®ç›®æ ‡è¯»è€…çš„éœ€æ±‚å’Œé˜…è¯»ä¹ æƒ¯ï¼Œä¼˜åŒ–ä¹¦ç±ç»“æ„ï¼Œä½¿å…¶æ˜“äºé˜…è¯»å¹¶å…·æœ‰å¸å¼•åŠ›ã€‚

## Rules
1. åŸºäºç”¨æˆ·æä¾›çš„ä¹¦ç±æ ‡é¢˜å’Œç®€ä»‹ï¼Œç”Ÿæˆå®Œæ•´çš„ä¹¦ç±å¤§çº²ã€‚
2. å¤§çº²éœ€è¦åŒ…æ‹¬ä¹¦ç±çš„ä¸»è¦ç« èŠ‚å’Œæ¯ä¸€ç« èŠ‚çš„å…³é”®å†…å®¹æ¦‚è¿°ã€‚
3. ç¡®ä¿å¤§çº²çš„ç»“æ„åˆç†ï¼Œå†…å®¹è¿è´¯ï¼Œæœ‰åŠ©äºæ¨è¿›ä¹¦ç±çš„ä¸»é¢˜å’Œæƒ…èŠ‚å‘å±•ã€‚
4. ä¹¦ç±å¤§çº²åº”ä½“ç°ä¹¦ç±çš„æ ¸å¿ƒä¸»é¢˜ï¼Œå¹¶ç¬¦åˆè¯»è€…çš„æœŸå¾…ã€‚

## Goals
ä¹¦ç±ä¸»é¢˜ï¼š{theme}
ä¹¦ç±æ ‡é¢˜å’Œç®€ä»‹ï¼š
{intro}

æ’°å†™ä¹¦ç±å¤§çº²ï¼ˆpython list æ ¼å¼,10-20ç« ï¼‰
["ç¬¬ä¸€ç« ï¼šã€Šxxxã€‹xxx", "ç¬¬äºŒç« ï¼šã€Šxxxã€‹xxx","...", "xxx"]

## Init
è®¾è®¡åˆé€‚çš„ç« èŠ‚å¤§çº²ï¼Œåªè¾“å‡º python listå†…å®¹ï¼Œæ­¤å¤–ä¸è¦ç»™å‡ºä»»ä½•æ— å…³å†…å®¹å’Œå­—ç¬¦ã€‚
```

ï¼ˆ3ï¼‰ ä¹¦ç±æ­£æ–‡å†…å®¹æ’°å†™æç¤ºè¯

```
# Role: ä¹¦ç±å†™ä½œä¸“å®¶

## Profile
- author: LangGPT
- version: 1.0
- language: ä¸­æ–‡/è‹±æ–‡
- description: å¸®åŠ©ç”¨æˆ·æ ¹æ®æä¾›çš„ä¹¦ç±æ ‡é¢˜ã€ç®€ä»‹å’Œç« èŠ‚å¤§çº²ï¼Œæ’°å†™æ¯ä¸€ç« çš„å…·ä½“å†…å®¹ï¼Œç¡®ä¿è¯­è¨€é£æ ¼ç¬¦åˆä¹¦ç±å®šä½ï¼Œå†…å®¹è¿è´¯ã€ä¸“ä¸šã€æ­£å¼ã€‚

## Skills
1. ç« èŠ‚å†…å®¹æ’°å†™ï¼šèƒ½å¤Ÿæ ¹æ®ç”¨æˆ·æä¾›çš„ç« èŠ‚å¤§çº²ï¼Œæ’°å†™å®Œæ•´çš„ç« èŠ‚å†…å®¹ï¼Œç¡®ä¿æƒ…èŠ‚å‘å±•å’Œä¸»é¢˜çš„æ·±åº¦æ¢è®¨ã€‚
2. æ–‡ä½“å’Œé£æ ¼åŒ¹é…ï¼šæ ¹æ®ä¹¦ç±çš„ç±»å‹ï¼ˆå°è¯´ã€çºªå®ã€å­¦æœ¯ç­‰ï¼‰å’Œç›®æ ‡è¯»è€…ï¼Œè°ƒæ•´å†™ä½œé£æ ¼ï¼Œä½¿å…¶æ­£å¼ã€ä¸“ä¸šä¸”ç¬¦åˆä¹¦ç±å®šä½ã€‚
3. ç»†èŠ‚æå†™ä¸é€»è¾‘æ„å»ºï¼šæ“…é•¿ç»†èŠ‚æå†™ï¼Œå¢å¼ºæ•…äº‹çš„çœŸå®æ„Ÿä¸æƒ…æ„Ÿæ·±åº¦ï¼Œä¿è¯é€»è¾‘ä¸¥å¯†æ€§ã€‚
4. å†…å®¹æ·±åŒ–ä¸æ‰©å±•ï¼šåœ¨å¤§çº²åŸºç¡€ä¸Šï¼Œåˆç†æ‰©å±•å’Œæ·±åŒ–å†…å®¹ï¼Œä½¿æ¯ä¸€ç« æœ‰è¶³å¤Ÿçš„ä¸°å¯Œæ€§å’Œä¿¡æ¯é‡ã€‚

## Rules
1. ä¾æ®ç”¨æˆ·æä¾›çš„ä¹¦ç±æ ‡é¢˜ã€ç®€ä»‹å’Œå¤§çº²ï¼Œæ’°å†™æ¯ä¸€ç« çš„è¯¦ç»†å†…å®¹ã€‚
2. æ¯ç« å†…å®¹éœ€ç¬¦åˆä¹¦ç±ä¸»é¢˜ï¼Œå¹¶åœ¨æƒ…èŠ‚ã€é€»è¾‘å’Œè¯­è¨€é£æ ¼ä¸Šä¿æŒä¸€è‡´ã€‚
3. ç¡®ä¿å†…å®¹ä¸°å¯Œã€ä¿¡æ¯æ¸…æ™°ï¼Œé¿å…ä¸å¿…è¦çš„é‡å¤æˆ–åç¦»ä¸»é¢˜ã€‚
4. ä¿æŒæ­£å¼ã€ä¸“ä¸šçš„è¯­è¨€é£æ ¼ï¼Œé€‚åˆç›®æ ‡è¯»è€…ã€‚
5. ä¸éœ€èƒ¡è¯´å…«é“ï¼Œç¼–é€ äº‹å®ã€‚


## Goals
ä¹¦ç±ç®€ä»‹ï¼š
{book_content}

æœ¬ç« å¤§çº²ï¼š
{chapter_intro}

è¯·ä¾æ®æœ¬ç« å¤§çº²å’Œä¹¦ç±ç®€ä»‹æ’°å†™æœ¬ç« å†…å®¹ã€‚

## OutputFormat:
- å¦‚æœéœ€è¦æ•°å­¦å…¬å¼ï¼Œä½¿ç”¨å†™æ³•:"$latexå…¬å¼$"ï¼Œä½¿å…¶èƒ½è¢« markdown æ­£ç¡®æ¸²æŸ“ï¼Œç¤ºä¾‹ï¼š"$z = \sum_{i=1}^{n} w_i \cdot x_i + b$"ã€‚
ï¼ˆæ³¨æ„ï¼šä½ çš„æ•°å­¦å…¬å¼ä¸è¦ç”¨ "\[ \]" å†™æ³•ï¼Œè¿™æ ·æ— æ³•è¢«æ­£ç¡®æ¸²æŸ“ï¼ï¼ï¼ï¼‰
- ç»“æ„åŒ–å†™ä½œï¼Œä½¿ç”¨ markdown æ ¼å¼æ’ç‰ˆå†…å®¹ã€‚
- ç« èŠ‚æ ‡é¢˜ï¼Œç¤ºä¾‹:"# ç¬¬ä¸‰ç« ï¼šTransformerçš„åŸºç¡€åŸç†"
- ç« èŠ‚å†…å°æ ‡é¢˜ä½¿ç”¨åºå·, ç¤ºä¾‹:"## 3.1 Transformerçš„æ¶æ„"ã€‚
- åˆç†æŒ‰éœ€ä½¿ç”¨ç²—ä½“ï¼Œæ–œä½“ï¼Œå¼•ç”¨ï¼Œä»£ç ï¼Œå…¬å¼ï¼Œåˆ—è¡¨ã€‚

## Init
è®¾è®¡åˆé€‚çš„ç« èŠ‚å¤§çº²ï¼Œåªè¾“å‡ºæœ¬ç« å†…å®¹ï¼Œæ­¤å¤–ä¸è¦ç»™å‡ºä»»ä½•æ— å…³å†…å®¹å’Œå­—ç¬¦ã€‚
```

ï¼ˆ4ï¼‰ ä½¿ç”¨ä»£ç å°†è¿™äº›æç¤ºè¯çš„è¾“å…¥è¾“å‡ºä¸²èµ·æ¥

```
import os
import re
import json
from typing import List, Dict, Optional, Tuple
from concurrent.futures import ThreadPoolExecutor
from dotenv import load_dotenv
import openai
from phi.assistant import Assistant
from phi.llm.openai import OpenAIChat

# åŠ è½½ .env æ–‡ä»¶
load_dotenv()

def read_prompt(prompt_file: str, replacements: Dict[str, str]) -> str:
    """
    è¯»å–æç¤ºæ–‡ä»¶å¹¶æ›¿æ¢å ä½ç¬¦
    """
    with open(prompt_file, 'r', encoding='utf-8') as file:
        prompt = file.read()
    for key, value in replacements.items():
        prompt = prompt.replace(f"{{{key}}}", value)
    return prompt
def convert_latex_to_markdown(text):
    # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢å…¬å¼å¼€å§‹å’Œç»“æŸçš„ \[ å’Œ \]ï¼Œä½†ä¸æ›¿æ¢å…¬å¼å†…éƒ¨çš„
    pattern = r'(?<!\\)\\\[((?:\\.|[^\\\]])*?)(?<!\\)\\\]'
    return re.sub(pattern, r'$$\1$$', text)

class BookWriter:
    """ç®¡ç†ä¹¦ç±ç”Ÿæˆè¿‡ç¨‹çš„ä¸»ç±»ã€‚"""

    def __init__(self, api_key: str, base_url: str, model_name: str, system_prompt=None):
        """åˆå§‹åŒ–BookWriterã€‚"""
        # ä½¿ç”¨openaiçš„æ¥å£è°ƒç”¨ä¹¦ç”Ÿæµ¦è¯­æ¨¡å‹

        self.api_key = os.getenv("API_KEY") if api_key is None else api_key
        self.base_url = os.getenv("BASE_URL") if base_url is None else base_url
        self.model_name = os.getenv("MODEL_NAME") if model_name is None else model_name

        if system_prompt is None:
            system_prompt = "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å†™ä½œåŠ©æ‰‹ï¼Œæ­£åœ¨å¸®åŠ©ç”¨æˆ·å†™ä¸€æœ¬ä¹¦ã€‚"
        self.assistant = self.create_assistant(self.model_name, self.api_key, self.base_url, system_prompt)
    
    def create_assistant(self, 
                        model_name: str, 
                        api_key: str, 
                        base_url: str, 
                        system_prompt: str) -> str:
        # æ¶¦è‰²æ–‡æœ¬
        self.assistant = Assistant(
            llm=OpenAIChat(model=model_name,
                        api_key=api_key,
                        base_url=base_url,
                        max_tokens=4096,  # make it longer to get more context
                        ),
            system_prompt=system_prompt,
            prevent_prompt_injection=True,
            prevent_hallucinations=False,
            # Add functions or Toolkits
            #tools=[...],
            # Show tool calls in LLM response.
            # show_tool_calls=True
        )
        return self.assistant

    def generate_title_and_intro(self, book_theme, prompt_file = "prompts/title_writer.txt") -> Tuple[str, str]:
        """ç”Ÿæˆä¹¦ç±æ ‡é¢˜å’Œä¸»è¦å†…å®¹ä»‹ç»ã€‚

        Args:
            prompt: ç”¨äºç”Ÿæˆæ ‡é¢˜å’Œä»‹ç»çš„æç¤ºã€‚

        Returns:
            åŒ…å«ç”Ÿæˆçš„æ ‡é¢˜å’Œä»‹ç»çš„å…ƒç»„ã€‚
        """
        prompt_args = {"theme": book_theme}
        prompt = read_prompt(prompt_file, prompt_args)
        #print(prompt)
        for attempt in range(3):
            try:
                response = self.assistant.run(prompt, stream=False)
                # convert to json
                response = response.strip()
                if not response.startswith('{'):
                    response = '{' + response.split('{', 1)[1]
                if not response.endswith('}'):
                    response = response.split('}', 1)[0] + '}'

                book_title_and_intro = json.loads(response)

                #print(book_title_and_intro)

                return book_title_and_intro
            except Exception as e:
                print(f"Attempt {attempt + 1} failed: {e}")
        return response

    def generate_outline(self, book_theme, book_title_and_intro: str, prompt_file= "prompts/outline_writer.txt") -> List[str]:
        """ç”Ÿæˆä¹¦ç±ç« èŠ‚å¤§çº²ã€‚

        Args:
            prompt: ç”¨äºç”Ÿæˆå¤§çº²çš„æç¤ºã€‚
            title: ä¹¦ç±æ ‡é¢˜ã€‚
            intro: ä¹¦ç±ä»‹ç»ã€‚

        Returns:
            ç« èŠ‚æ ‡é¢˜åˆ—è¡¨ã€‚
        """
        prompt_args = {"theme": book_theme, "intro": str(book_title_and_intro)}
        prompt = read_prompt(prompt_file, prompt_args)
        for attempt in range(3):
            try:
                response = self.assistant.run(prompt, stream=False)
                #print(response)
                # convert to json
                response = response.strip()
                if not response.startswith('['):
                    response = '[' + response.split('[', 1)[1]
                if not response.endswith(']'):
                    response = response.split(']', 1)[0] + ']'
                chapters = json.loads(response.strip())
                #print(chapters)
                return chapters
            except Exception as e:
                print(f"Attempt {attempt + 1} failed: {e}")
        return response

    def generate_chapter(self, book_content, chapter_intro, prompt_file= "prompts/chapter_writer.txt") -> str:
        """ç”Ÿæˆå•ä¸ªç« èŠ‚çš„å†…å®¹ã€‚

        Args:
            chapter_title: ç« èŠ‚æ ‡é¢˜ã€‚
            book_title: ä¹¦ç±æ ‡é¢˜ã€‚
            book_intro: ä¹¦ç±ä»‹ç»ã€‚
            outline: å®Œæ•´çš„ç« èŠ‚å¤§çº²ã€‚
            prompt: ç”¨äºç”Ÿæˆç« èŠ‚çš„æç¤ºã€‚

        Returns:
            ç”Ÿæˆçš„ç« èŠ‚å†…å®¹ã€‚
        """
        
        prompt_args = {"book_content": str(book_content), "chapter_intro": str(chapter_intro)}
        prompt = read_prompt(prompt_file, prompt_args)
        for attempt in range(3):
            try:
                response = self.assistant.run(prompt, stream=False)
                response.strip()
                if response.startswith('```markdown'):
                    # åˆ é™¤ç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œ
                    lines = response.splitlines()
                    response = '\n'.join(lines[1:-1])

                return response
            except Exception as e:
                print(f"Attempt {attempt + 1} failed: {e}")
        response = convert_latex_to_markdown(response)
        return response

    def generate_book(self, custom_theme=None, save_file=False) -> None:
        """ç”Ÿæˆæ•´æœ¬ä¹¦å¹¶å°†å…¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚

        Args:
            custom_prompts: è‡ªå®šä¹‰æç¤ºçš„å­—å…¸ã€‚å¯ä»¥åŒ…æ‹¬ 'title_intro', 'outline' å’Œ 'chapter' é”®ã€‚
        """

        print("å¼€å§‹ç”Ÿæˆä¹¦ç±æ ‡é¢˜å’Œä»‹ç»...")
        theme = custom_theme if custom_theme else "Transformeræ˜¯ä»€ä¹ˆ"
        title_and_intro = self.generate_title_and_intro(theme)
        title = title_and_intro["title"]
        print(f"ä¹¦ç±æ ‡é¢˜å’Œä»‹ç»:\n {title_and_intro}")

        print("\nå¼€å§‹ç”Ÿæˆç« èŠ‚å¤§çº²...")
        chapters = self.generate_outline(theme, title_and_intro)
        print("ç« èŠ‚å¤§çº²:")
        print(chapters)

        book_intro = title_and_intro
        book_content = "# " + title

        # ä½¿ç”¨çº¿ç¨‹æ± æ¥å¹¶è¡Œç”Ÿæˆç« èŠ‚å†…å®¹
        print("\nå¼€å§‹åˆ›ä½œæ­£æ–‡å†…å®¹ï¼Œæ—¶é—´è¾ƒé•¿ï¼ˆçº¦å‡ åˆ†é’Ÿï¼‰è¯·ç­‰å¾…~")
        with ThreadPoolExecutor() as executor:
            chapter_contents = list(executor.map(self.generate_chapter, [book_intro]*len(chapters), chapters))

        for i, chapter in enumerate(chapters, 1):
            print(f"\næ­£åœ¨ç”Ÿæˆç¬¬{i}ç« ï¼š{chapter}")
            chapter_content = chapter_contents[i-1].strip()  # è·å–å·²ç”Ÿæˆçš„ç« èŠ‚å†…å®¹
            print(chapter_content)
            book_content += f"\n\n{chapter_content}"
            print(f"ç¬¬{i}ç« å·²å®Œæˆã€‚")

        print("\næ•´æœ¬ä¹¦å·²ç”Ÿæˆå®Œæ¯•ã€‚")
        if save_file:
            filename = f"books/{title.replace(' ', '_')}.md"
            with open(filename, "w", encoding="utf-8") as f:
                f.write(book_content)
            
            print(f"ä¹¦ç±å†…å®¹å·²ä¿å­˜åˆ° {filename} æ–‡ä»¶ä¸­ã€‚")
        return book_content

def main():
    """ä¸»å‡½æ•°, æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨BookWriterç±»ã€‚"""
    book_theme = input("è¯·è¾“å…¥ä¹¦ç±ä¸»é¢˜(å¦‚ AI æ˜¯ä»€ä¹ˆï¼Ÿ): ")

    api_key = os.getenv("API_KEY")
    base_url = os.getenv("BASE_URL")
    model_name = os.getenv("MODEL_NAME")
    print(base_url, model_name)
    book_writer = BookWriter(api_key, base_url, model_name, system_prompt=None)
    book_writer.generate_book(custom_theme=book_theme, save_file=True)

if __name__ == "__main__":
    main()
```

#### 4.2.5 é¡¹ç›®ä¼˜åŒ–

å½“å‰çš„å†™ä¹¦é¡¹ç›®åªæ˜¯ä¸ªå° demoï¼Œè¿˜å­˜åœ¨è®¸å¤šé—®é¢˜ï¼ŒåŒå­¦ä»¬å¯ä»¥è¯•ç€ä¼˜åŒ–è¿™äº›é—®é¢˜ã€‚ä¸€äº›å·²çŸ¥çš„é—®é¢˜å’Œä¼˜åŒ–æ–¹å‘ï¼š

    1. ç« èŠ‚æ­£æ–‡å†…å®¹çš„è´¨é‡æå‡ã€‚ä¼˜åŒ–å†…å®¹è¡¨è¾¾ã€å†…å®¹çš„æ·±åº¦ã€æ ¼å¼æ’ç‰ˆç­‰ï¼Œå°¤å…¶æ•°å­¦å…¬å¼çš„æ ¼å¼å’Œæ’ç‰ˆã€‚
    2. å„ç« èŠ‚å†…å®¹çš„è¿è´¯æ€§ã€‚
    3. ç« èŠ‚æ­£æ–‡é•¿åº¦æå‡ã€‚
    4. è®©å›¾ä¹¦å›¾æ–‡å¹¶èŒ‚ï¼šä½¿ç”¨ mardown çš„å›¾ç‰‡è¯­æ³•é…å›¾ï¼Œæˆ–è€…æ­é…ç”Ÿå›¾æ¨¡å‹ç”Ÿæˆå›¾ç‰‡ã€‚
    5. å…¶ä»–ä½ èƒ½æƒ³åˆ°çš„ä¼˜åŒ–æ–¹å‘ã€‚



# æœ¬ç« å°ç»“

æœ¬ç« æ·±å…¥æ¢è®¨äº†æç¤ºå·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰çš„ç†è®ºä¸å®è·µï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§åº”ç”¨ï¼Œä¸ºè¯»è€…æä¾›äº†å…¨é¢çš„å­¦ä¹ è·¯å¾„ã€‚

æˆ‘ä»¬é¦–å…ˆä»‹ç»äº†æç¤ºè¯ï¼ˆPromptï¼‰çš„å®šä¹‰åŠå…¶åœ¨ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ä¸­çš„é‡è¦ä½œç”¨ã€‚éšåï¼Œæˆ‘ä»¬æ¢è®¨äº†æç¤ºå·¥ç¨‹çš„åŸºæœ¬åŸåˆ™å’ŒæŠ€å·§ï¼ŒåŒ…æ‹¬CRISPEå’ŒCO-STARç­‰å¸¸è§çš„æç¤ºè¯è®¾è®¡æ¡†æ¶ã€‚

æ¥ç€ï¼Œæˆ‘ä»¬é‡ç‚¹ä»‹ç»äº†LangGPTç»“æ„åŒ–æç¤ºè¯æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•å€Ÿé‰´äº†é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„æ€æƒ³ï¼Œæä¾›äº†ä¸€ç§æ¨¡å—åŒ–ã€æ ‡å‡†åŒ–çš„æç¤ºè¯ç¼–å†™æ–¹æ³•è®ºã€‚æˆ‘ä»¬è¯¦ç»†è®²è§£äº†LangGPTçš„åŸºæœ¬ç»“æ„ã€ç¼–å†™æŠ€å·§ä»¥åŠå¸¸ç”¨æ¨¡å—ï¼Œä¸ºè¯»è€…æä¾›äº†å®ç”¨çš„å·¥å…·æ¥æé«˜æç¤ºè¯çš„è´¨é‡å’Œæ•ˆæœã€‚

åœ¨å®è·µéƒ¨åˆ†ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨æµ¦è¯­å¤§æ¨¡å‹è¿›è¡Œæç¤ºå·¥ç¨‹å®è·µã€‚é€šè¿‡å…·ä½“çš„æ¡ˆä¾‹ï¼Œå¦‚è‡ªåŠ¨åŒ–ç”Ÿæˆæç¤ºè¯å’Œå°çº¢ä¹¦æ–‡æ¡ˆåŠ©æ‰‹ï¼Œæˆ‘ä»¬å±•ç¤ºäº†LangGPTæ¡†æ¶åœ¨å®é™…åº”ç”¨ä¸­çš„å¼ºå¤§åŠŸèƒ½ã€‚

æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ª"ä¸€é”®å†™ä¹¦"ç³»ç»Ÿçš„å¼€å‘å®æˆ˜ï¼Œå°†ç†è®ºçŸ¥è¯†åº”ç”¨åˆ°å®é™…é¡¹ç›®ä¸­ã€‚æˆ‘ä»¬è¯¦ç»†è®²è§£äº†é¡¹ç›®çš„æ¶æ„ã€æ ¸å¿ƒä»£ç å®ç°ï¼Œä»¥åŠæ½œåœ¨çš„ä¼˜åŒ–æ–¹å‘ï¼Œä¸ºè¯»è€…æä¾›äº†ä¸€ä¸ªç»¼åˆæ€§çš„å­¦ä¹ æ¡ˆä¾‹ã€‚

é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œè¯»è€…åº”è¯¥èƒ½å¤Ÿç†è§£æç¤ºå·¥ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒæŒæ¡LangGPTç»“æ„åŒ–æç¤ºè¯çš„ç¼–å†™æ–¹æ³•ï¼Œå¹¶èƒ½å¤Ÿå°†è¿™äº›çŸ¥è¯†åº”ç”¨åˆ°å®é™…çš„AIåº”ç”¨å¼€å‘ä¸­ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿé¼“åŠ±è¯»è€…åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œè¿›ä¸€æ­¥çš„æ¢ç´¢å’Œåˆ›æ–°ï¼Œä»¥å……åˆ†å‘æŒ¥å¤§è¯­è¨€æ¨¡å‹çš„æ½œåŠ›ã€‚
